/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Namespace(device='cuda', alpha=0.8, beta=1.0, lr=0.0001, pretrain_epochs=10, num_epochs=5, noise_strength=0.1, no_adversarial=True, visualize=False, debug=False, no_cam=False, seed=42, threshold=0.5, positive_weight=0.97)
Number of GPUs available: 8
Number of samples in training dataset: 21019 | testing dataset:2265
positive weight: 3.1028
Training:   0%|          | 0/657 [00:00<?, ?it/s]Training:   0%|          | 0/657 [00:08<?, ?it/s, Loss=0.649, Avg Loss=0.0203, Accuracy=0.625]Training:   0%|          | 1/657 [00:08<1:31:40,  8.38s/it, Loss=0.649, Avg Loss=0.0203, Accuracy=0.625]Training:   0%|          | 1/657 [00:08<1:31:40,  8.38s/it, Loss=0.703, Avg Loss=0.0211, Accuracy=0.5]  Training:   0%|          | 2/657 [00:08<38:51,  3.56s/it, Loss=0.703, Avg Loss=0.0211, Accuracy=0.5]  Training:   0%|          | 2/657 [00:08<38:51,  3.56s/it, Loss=0.692, Avg Loss=0.0213, Accuracy=0.448]Training:   0%|          | 3/657 [00:08<21:58,  2.02s/it, Loss=0.692, Avg Loss=0.0213, Accuracy=0.448]Training:   0%|          | 3/657 [00:08<21:58,  2.02s/it, Loss=0.761, Avg Loss=0.0219, Accuracy=0.391]Training:   1%|          | 4/657 [00:08<13:58,  1.28s/it, Loss=0.761, Avg Loss=0.0219, Accuracy=0.391]Training:   1%|          | 4/657 [00:09<13:58,  1.28s/it, Loss=0.68, Avg Loss=0.0218, Accuracy=0.406] Training:   1%|          | 5/657 [00:09<09:27,  1.15it/s, Loss=0.68, Avg Loss=0.0218, Accuracy=0.406]Training:   1%|          | 5/657 [00:09<09:27,  1.15it/s, Loss=0.709, Avg Loss=0.0218, Accuracy=0.391]Training:   1%|          | 6/657 [00:09<06:50,  1.59it/s, Loss=0.709, Avg Loss=0.0218, Accuracy=0.391]Training:   1%|          | 6/657 [00:09<06:50,  1.59it/s, Loss=0.699, Avg Loss=0.0218, Accuracy=0.388]Training:   1%|          | 7/657 [00:09<05:04,  2.13it/s, Loss=0.699, Avg Loss=0.0218, Accuracy=0.388]Training:   1%|          | 7/657 [00:09<05:04,  2.13it/s, Loss=0.707, Avg Loss=0.0219, Accuracy=0.395]Training:   1%|          | 8/657 [00:09<04:02,  2.68it/s, Loss=0.707, Avg Loss=0.0219, Accuracy=0.395]Training:   1%|          | 8/657 [00:09<04:02,  2.68it/s, Loss=0.696, Avg Loss=0.0219, Accuracy=0.389]Training:   1%|▏         | 9/657 [00:09<03:13,  3.35it/s, Loss=0.696, Avg Loss=0.0219, Accuracy=0.389]Training:   1%|▏         | 9/657 [00:09<03:13,  3.35it/s, Loss=0.722, Avg Loss=0.0219, Accuracy=0.378]Training:   2%|▏         | 10/657 [00:09<02:49,  3.81it/s, Loss=0.722, Avg Loss=0.0219, Accuracy=0.378]Training:   2%|▏         | 10/657 [00:09<02:49,  3.81it/s, Loss=0.669, Avg Loss=0.0218, Accuracy=0.395]Training:   2%|▏         | 11/657 [00:09<02:23,  4.51it/s, Loss=0.669, Avg Loss=0.0218, Accuracy=0.395]Training:   2%|▏         | 11/657 [00:10<02:23,  4.51it/s, Loss=0.699, Avg Loss=0.0218, Accuracy=0.398]Training:   2%|▏         | 12/657 [00:10<02:15,  4.77it/s, Loss=0.699, Avg Loss=0.0218, Accuracy=0.398]Training:   2%|▏         | 12/657 [00:10<02:15,  4.77it/s, Loss=0.693, Avg Loss=0.0218, Accuracy=0.399]Training:   2%|▏         | 13/657 [00:10<02:08,  4.99it/s, Loss=0.693, Avg Loss=0.0218, Accuracy=0.399]Training:   2%|▏         | 13/657 [00:10<02:08,  4.99it/s, Loss=0.706, Avg Loss=0.0218, Accuracy=0.402]Training:   2%|▏         | 14/657 [00:10<01:55,  5.55it/s, Loss=0.706, Avg Loss=0.0218, Accuracy=0.402]Training:   2%|▏         | 14/657 [00:10<01:55,  5.55it/s, Loss=0.741, Avg Loss=0.0219, Accuracy=0.39] Training:   2%|▏         | 15/657 [00:10<01:55,  5.55it/s, Loss=0.741, Avg Loss=0.0219, Accuracy=0.39]Training:   2%|▏         | 15/657 [00:10<01:55,  5.55it/s, Loss=0.68, Avg Loss=0.0219, Accuracy=0.395]Training:   2%|▏         | 16/657 [00:10<02:00,  5.34it/s, Loss=0.68, Avg Loss=0.0219, Accuracy=0.395]Training:   2%|▏         | 16/657 [00:10<02:00,  5.34it/s, Loss=0.725, Avg Loss=0.0219, Accuracy=0.386]Training:   3%|▎         | 17/657 [00:10<01:50,  5.82it/s, Loss=0.725, Avg Loss=0.0219, Accuracy=0.386]Training:   3%|▎         | 17/657 [00:11<01:50,  5.82it/s, Loss=0.681, Avg Loss=0.0219, Accuracy=0.392]Training:   3%|▎         | 18/657 [00:11<01:50,  5.81it/s, Loss=0.681, Avg Loss=0.0219, Accuracy=0.392]Training:   3%|▎         | 18/657 [00:11<01:50,  5.81it/s, Loss=0.703, Avg Loss=0.0219, Accuracy=0.387]Training:   3%|▎         | 19/657 [00:11<01:52,  5.69it/s, Loss=0.703, Avg Loss=0.0219, Accuracy=0.387]Training:   3%|▎         | 19/657 [00:11<01:52,  5.69it/s, Loss=0.731, Avg Loss=0.0219, Accuracy=0.38] Training:   3%|▎         | 20/657 [00:11<01:43,  6.16it/s, Loss=0.731, Avg Loss=0.0219, Accuracy=0.38]Training:   3%|▎         | 20/657 [00:11<01:43,  6.16it/s, Loss=0.739, Avg Loss=0.022, Accuracy=0.379]Training:   3%|▎         | 21/657 [00:11<01:46,  5.99it/s, Loss=0.739, Avg Loss=0.022, Accuracy=0.379]Training:   3%|▎         | 21/657 [00:11<01:46,  5.99it/s, Loss=0.724, Avg Loss=0.022, Accuracy=0.376]Training:   3%|▎         | 22/657 [00:11<01:38,  6.45it/s, Loss=0.724, Avg Loss=0.022, Accuracy=0.376]Training:   3%|▎         | 22/657 [00:11<01:38,  6.45it/s, Loss=0.691, Avg Loss=0.022, Accuracy=0.382]Training:   4%|▎         | 23/657 [00:11<01:42,  6.21it/s, Loss=0.691, Avg Loss=0.022, Accuracy=0.382]Training:   4%|▎         | 23/657 [00:12<01:42,  6.21it/s, Loss=0.711, Avg Loss=0.022, Accuracy=0.384]Training:   4%|▎         | 24/657 [00:12<01:37,  6.49it/s, Loss=0.711, Avg Loss=0.022, Accuracy=0.384]Training:   4%|▎         | 24/657 [00:12<01:37,  6.49it/s, Loss=0.677, Avg Loss=0.022, Accuracy=0.39] Training:   4%|▍         | 25/657 [00:12<01:39,  6.37it/s, Loss=0.677, Avg Loss=0.022, Accuracy=0.39]Training:   4%|▍         | 25/657 [00:12<01:39,  6.37it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.387]Training:   4%|▍         | 26/657 [00:12<01:42,  6.14it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.387]Training:   4%|▍         | 26/657 [00:12<01:42,  6.14it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.389]Training:   4%|▍         | 27/657 [00:12<01:35,  6.59it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.389]Training:   4%|▍         | 27/657 [00:12<01:35,  6.59it/s, Loss=0.695, Avg Loss=0.022, Accuracy=0.392]Training:   4%|▍         | 28/657 [00:12<01:40,  6.28it/s, Loss=0.695, Avg Loss=0.022, Accuracy=0.392]Training:   4%|▍         | 28/657 [00:12<01:40,  6.28it/s, Loss=0.688, Avg Loss=0.022, Accuracy=0.39] Training:   4%|▍         | 29/657 [00:12<01:33,  6.70it/s, Loss=0.688, Avg Loss=0.022, Accuracy=0.39]Training:   4%|▍         | 29/657 [00:13<01:33,  6.70it/s, Loss=0.741, Avg Loss=0.022, Accuracy=0.39]Training:   5%|▍         | 30/657 [00:13<01:38,  6.35it/s, Loss=0.741, Avg Loss=0.022, Accuracy=0.39]Training:   5%|▍         | 30/657 [00:13<01:38,  6.35it/s, Loss=0.72, Avg Loss=0.022, Accuracy=0.393]Training:   5%|▍         | 31/657 [00:13<01:32,  6.79it/s, Loss=0.72, Avg Loss=0.022, Accuracy=0.393]Training:   5%|▍         | 31/657 [00:13<01:32,  6.79it/s, Loss=0.686, Avg Loss=0.022, Accuracy=0.396]Training:   5%|▍         | 32/657 [00:13<01:37,  6.41it/s, Loss=0.686, Avg Loss=0.022, Accuracy=0.396]Training:   5%|▍         | 32/657 [00:13<01:37,  6.41it/s, Loss=0.697, Avg Loss=0.022, Accuracy=0.401]Training:   5%|▌         | 33/657 [00:13<01:31,  6.83it/s, Loss=0.697, Avg Loss=0.022, Accuracy=0.401]Training:   5%|▌         | 33/657 [00:13<01:31,  6.83it/s, Loss=0.687, Avg Loss=0.022, Accuracy=0.406]Training:   5%|▌         | 34/657 [00:13<01:37,  6.41it/s, Loss=0.687, Avg Loss=0.022, Accuracy=0.406]Training:   5%|▌         | 34/657 [00:13<01:37,  6.41it/s, Loss=0.712, Avg Loss=0.022, Accuracy=0.407]Training:   5%|▌         | 35/657 [00:13<01:30,  6.84it/s, Loss=0.712, Avg Loss=0.022, Accuracy=0.407]Training:   5%|▌         | 35/657 [00:13<01:30,  6.84it/s, Loss=0.723, Avg Loss=0.022, Accuracy=0.408]Training:   5%|▌         | 36/657 [00:13<01:36,  6.41it/s, Loss=0.723, Avg Loss=0.022, Accuracy=0.408]Training:   5%|▌         | 36/657 [00:14<01:36,  6.41it/s, Loss=0.71, Avg Loss=0.022, Accuracy=0.41]  Training:   6%|▌         | 37/657 [00:14<01:31,  6.78it/s, Loss=0.71, Avg Loss=0.022, Accuracy=0.41]Training:   6%|▌         | 37/657 [00:14<01:31,  6.78it/s, Loss=0.734, Avg Loss=0.022, Accuracy=0.41]Training:   6%|▌         | 38/657 [00:14<01:37,  6.38it/s, Loss=0.734, Avg Loss=0.022, Accuracy=0.41]Training:   6%|▌         | 38/657 [00:14<01:37,  6.38it/s, Loss=0.704, Avg Loss=0.022, Accuracy=0.411]Training:   6%|▌         | 39/657 [00:14<01:32,  6.68it/s, Loss=0.704, Avg Loss=0.022, Accuracy=0.411]Training:   6%|▌         | 39/657 [00:14<01:32,  6.68it/s, Loss=0.68, Avg Loss=0.022, Accuracy=0.416] Training:   6%|▌         | 40/657 [00:14<01:37,  6.32it/s, Loss=0.68, Avg Loss=0.022, Accuracy=0.416]Training:   6%|▌         | 40/657 [00:14<01:37,  6.32it/s, Loss=0.727, Avg Loss=0.022, Accuracy=0.416]Training:   6%|▌         | 41/657 [00:14<01:41,  6.09it/s, Loss=0.727, Avg Loss=0.022, Accuracy=0.416]Training:   6%|▌         | 41/657 [00:14<01:41,  6.09it/s, Loss=0.693, Avg Loss=0.022, Accuracy=0.42] Training:   6%|▋         | 42/657 [00:14<01:33,  6.55it/s, Loss=0.693, Avg Loss=0.022, Accuracy=0.42]Training:   6%|▋         | 42/657 [00:15<01:33,  6.55it/s, Loss=0.696, Avg Loss=0.022, Accuracy=0.424]Training:   7%|▋         | 43/657 [00:15<01:38,  6.24it/s, Loss=0.696, Avg Loss=0.022, Accuracy=0.424]Training:   7%|▋         | 43/657 [00:15<01:38,  6.24it/s, Loss=0.697, Avg Loss=0.022, Accuracy=0.427]Training:   7%|▋         | 44/657 [00:15<01:31,  6.67it/s, Loss=0.697, Avg Loss=0.022, Accuracy=0.427]Training:   7%|▋         | 44/657 [00:15<01:31,  6.67it/s, Loss=0.69, Avg Loss=0.022, Accuracy=0.433] Training:   7%|▋         | 45/657 [00:15<01:36,  6.32it/s, Loss=0.69, Avg Loss=0.022, Accuracy=0.433]Training:   7%|▋         | 45/657 [00:15<01:36,  6.32it/s, Loss=0.677, Avg Loss=0.022, Accuracy=0.438]Training:   7%|▋         | 46/657 [00:15<01:30,  6.77it/s, Loss=0.677, Avg Loss=0.022, Accuracy=0.438]Training:   7%|▋         | 46/657 [00:15<01:30,  6.77it/s, Loss=0.692, Avg Loss=0.022, Accuracy=0.441]Training:   7%|▋         | 47/657 [00:15<01:36,  6.30it/s, Loss=0.692, Avg Loss=0.022, Accuracy=0.441]Training:   7%|▋         | 47/657 [00:15<01:36,  6.30it/s, Loss=0.687, Avg Loss=0.022, Accuracy=0.444]Training:   7%|▋         | 48/657 [00:15<01:41,  5.98it/s, Loss=0.687, Avg Loss=0.022, Accuracy=0.444]Training:   7%|▋         | 48/657 [00:15<01:41,  5.98it/s, Loss=0.714, Avg Loss=0.022, Accuracy=0.446]Training:   7%|▋         | 49/657 [00:15<01:34,  6.45it/s, Loss=0.714, Avg Loss=0.022, Accuracy=0.446]Training:   7%|▋         | 49/657 [00:16<01:34,  6.45it/s, Loss=0.691, Avg Loss=0.022, Accuracy=0.448]Training:   8%|▊         | 50/657 [00:16<01:38,  6.15it/s, Loss=0.691, Avg Loss=0.022, Accuracy=0.448]Training:   8%|▊         | 50/657 [00:16<01:38,  6.15it/s, Loss=0.711, Avg Loss=0.022, Accuracy=0.449]Training:   8%|▊         | 51/657 [00:16<01:31,  6.59it/s, Loss=0.711, Avg Loss=0.022, Accuracy=0.449]Training:   8%|▊         | 51/657 [00:16<01:31,  6.59it/s, Loss=0.714, Avg Loss=0.022, Accuracy=0.453]Training:   8%|▊         | 52/657 [00:16<01:49,  5.52it/s, Loss=0.714, Avg Loss=0.022, Accuracy=0.453]Training:   8%|▊         | 52/657 [00:16<01:49,  5.52it/s, Loss=0.673, Avg Loss=0.022, Accuracy=0.457]Training:   8%|▊         | 53/657 [00:16<01:40,  5.98it/s, Loss=0.673, Avg Loss=0.022, Accuracy=0.457]Training:   8%|▊         | 53/657 [00:16<01:40,  5.98it/s, Loss=0.735, Avg Loss=0.022, Accuracy=0.458]Training:   8%|▊         | 54/657 [00:16<01:34,  6.40it/s, Loss=0.735, Avg Loss=0.022, Accuracy=0.458]Training:   8%|▊         | 54/657 [00:16<01:34,  6.40it/s, Loss=0.684, Avg Loss=0.022, Accuracy=0.461]Training:   8%|▊         | 55/657 [00:16<01:36,  6.24it/s, Loss=0.684, Avg Loss=0.022, Accuracy=0.461]Training:   8%|▊         | 55/657 [00:17<01:36,  6.24it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.462]Training:   9%|▊         | 56/657 [00:17<01:40,  6.00it/s, Loss=0.709, Avg Loss=0.022, Accuracy=0.462]Training:   9%|▊         | 56/657 [00:17<01:40,  6.00it/s, Loss=0.724, Avg Loss=0.022, Accuracy=0.461]Training:   9%|▊         | 57/657 [00:17<01:33,  6.42it/s, Loss=0.724, Avg Loss=0.022, Accuracy=0.461]Training:   9%|▊         | 57/657 [00:17<01:33,  6.42it/s, Loss=0.682, Avg Loss=0.022, Accuracy=0.464]Training:   9%|▉         | 58/657 [00:17<01:36,  6.18it/s, Loss=0.682, Avg Loss=0.022, Accuracy=0.464]Training:   9%|▉         | 58/657 [00:17<01:36,  6.18it/s, Loss=0.708, Avg Loss=0.022, Accuracy=0.466]Training:   9%|▉         | 59/657 [00:17<01:30,  6.60it/s, Loss=0.708, Avg Loss=0.022, Accuracy=0.466]Training:   9%|▉         | 59/657 [00:17<01:30,  6.60it/s, Loss=0.674, Avg Loss=0.022, Accuracy=0.469]Training:   9%|▉         | 60/657 [00:17<01:35,  6.23it/s, Loss=0.674, Avg Loss=0.022, Accuracy=0.469]Training:   9%|▉         | 60/657 [00:17<01:35,  6.23it/s, Loss=0.712, Avg Loss=0.022, Accuracy=0.468]Training:   9%|▉         | 61/657 [00:17<01:39,  6.01it/s, Loss=0.712, Avg Loss=0.022, Accuracy=0.468]